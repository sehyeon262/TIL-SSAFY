{% extends "base.html" %}
{% load crispy_forms_tags %}

{% block content %}

<h1 class="my-3">영화 상세 페이지</h1>
<br><br>

<h2>{{ movie.title }}</h2>
<p>{{ movie.summary }}</p>
<b>{{ movie.director }}</b><br>
<b>장르 : {{ movie.genre }}</b><br>
<b>평점 : {{ movie.rating }}</b>
<hr>

<div class="d-flex">
  <div>
    {% if movie.director_img_url %}
      <img src="{{ movie.director_img_url }}" alt="감독 사진" width="150">
    {% endif %}
  </div>
  <div class="mx-3">
    <h4>{{ movie.director }}</h4>
    <p><strong>대표작:</strong> {{ movie.director_works }}</p>
    <p>{{ movie.director_info }}</p>
    <small style="color:gray;">
      감독 대표작과 감독 정보는 AI가 생성한 정보로, 정확하지 않을 수 있습니다.
    </small>
  </div>
</div>

<hr>
<div class="d-flex">
  <div>
    <a href="{% url "movies:update" movie.pk %}" class="btn btn-dark">UPDATE</a>
  </div>
  <form action="{% url "movies:delete" movie.pk %}" method="POST">
    {% csrf_token %}
    <input type="submit" class="btn btn-danger mx-1" value="DELETE">
  </form>
</div>

<hr>

<h3>댓글 목록</h3>
<ul class="list-group">
  {% for comment in comments %}
    <li class="list-group-item d-flex justify-content-between align-items-center">
      {{ comment.content }}
      {% if request.user == comment.user %}
        <form action="{% url "movies:comments_delete" comment.pk movie.pk %}" method="POST" class="m-0">
          {% csrf_token %}
          <button type="submit" class="btn btn-outline-danger btn-sm">삭제</button>
        </form>
      {% endif %}
    </li>
  {% empty %}
    <li class="list-group-item">아직 댓글이 없어요.</li>
  {% endfor %}
</ul>


<form action="{% url 'movies:comments_create' movie.pk %}" method="POST" class="d-flex align-items-center gap-2">
  {% csrf_token %}
  {{ form.content }} 
  <input type="submit" class="btn btn-primary" value="제출">
</form>

<hr>
<a href="{% url "movies:index" %}" class="btn btn-primary">BACK</a>

{% endblock content %}





